---
description: Cookie consent, settings stores, vendor-based consent model, and UI components
globs: packages/utils/src/cookies/**, packages/ui/src/lib/components/utils/cookie-consent-*/**, **/cookies/**
---

# Cookie Stores (`@vesta-cx/utils/cookies`)

Client-side cookie utilities using nanostores + `@nanostores/persistent`.

## Consent model

Per-vendor granularity. `essential` (always true) and `preferences` are simple toggles. Analytics and advertising consent is per-vendor via `vendors: Record<string, VendorConsent>`.

See `packages/utils/src/cookies/` for store and helper APIs.

## Settings store

`settingsStore` — `persistentMap<UserSettings>`. Auto-applies `theme` → `data-theme`, `locale` → `<html lang>`, persists as `preferences:settings.*` cookies.

## UI components (`@vesta-cx/ui`)

- `packages/ui/src/lib/components/utils/cookie-consent-form/`
- `packages/ui/src/lib/components/utils/cookie-consent-dialog/`

Both accept `vendors: VendorDefinition[]` — the app defines its vendor list.

## Cross-domain

Call `configureCookies({ domain: '.vesta.cx' })` at app startup. Sets `domain` on all cookies. `SameSite=None` auto-sets `Secure`.
